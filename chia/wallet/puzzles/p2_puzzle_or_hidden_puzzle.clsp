(mod
  (
    HIDDEN_PUZZLE_HASH
    INNER_PUZZLE
    hidden_puzzle_reveal
    inner_or_hidden_solution
  )

  (include curry-and-treehash.clinc)
  (include utility_macros.clib)

  (if hidden_puzzle_reveal
      (assert (= HIDDEN_PUZZLE_HASH (sha256tree hidden_puzzle_reveal))
        ; then
        (a hidden_puzzle_reveal inner_or_hidden_solution)
      )
      (a INNER_PUZZLE inner_or_hidden_solution)
  )
)